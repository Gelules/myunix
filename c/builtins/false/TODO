Improve the testsuite.
Gocument the code.
